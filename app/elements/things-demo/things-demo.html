<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->
<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/juicy-ace-editor/juicy-ace-editor.html">

<link rel="import" href="../../bower_components/things-msg-box-behavior/things-msg-box-behavior.html">
<link rel="import" href="../../bower_components/things-global-behavior/things-global-behavior.html">
<link rel="import" href="../../bower_components/things-spinner/things-spinner-behavior.html">
<link rel="import" href="../../bower_components/things-upload/things-file-upload.html">
<link rel="import" href="../../bower_components/things-card/things-card-list.html">
<link rel="import" href="../../bower_components/things-card/things-img-card.html">
<link rel="import" href="../../bower_components/things-code-editor/things-template-editor.html">

<dom-module id="things-demo">
	<template>
		<style include="shared-styles"></style>
		<style>
			@import "things-demo";
		</style>

		<!-- others -->
		<paper-material class="Page-paper" elevation="1">
			<h2 class="Page-title">[[title]]</h2>

			<p class="paper-font-subhead">Things Components Demo</p>
		</paper-material>

		<paper-material class="Page-paper" elevation="1">
			<h2 class="Page-title">Things Component API & Docs</h2>
			<p class="paper-font-subhead"><a href="/elements/index.html" target="_blank">Component API & Demo</a></p>
		</paper-material>

		<things-file-upload target="upload" method="POST" timeout="300000" ></things-file-upload>

		<paper-material class="Page-paper" elevation="1">
			<p class="paper-font-subhead">Things Setting</p>

			<paper-input label="Base URL" value="{{globals.baseUrl}}"></paper-input>

			<things-setting id="setting"></things-setting>

			<div class="buttons">
				<things-button color="green" id="setting-btn">Setting</things-button>
			</div>
		</paper-material>

		<paper-material class="Page-paper" elevation="1">
			<p class="paper-font-subhead">Things Profile</p>

			<things-profile name="elidom" email="elidom@example.com" img="../../images/profile.png"></things-profile>
		</paper-material>

		<paper-material class="Page-paper" elevation="1">
			<p class="paper-font-subhead">Things Button</p>

			<paper-input  
				name="buttonAction" 
				type="text" 
				label="Button Action" 
				value="{{thingsButtonMessage}}">
			</paper-input>

			<div class="buttons">
				<things-button color="green" id="things-btn-1">Search Button</things-button>

				<things-button 
					id="things-btn-2" 
					color="indigo" 
					confirm=true 
					title="Confirm" 
					message="Are you sure to save?">Save Button</things-button>

				<things-button 
					id="things-btn-3" 
					color="pink" 
					confirm=true 
					title="Confirm" 
					message="Are you sure to delete?">Delete Button</things-button>
			</div>
		</paper-material>

		<paper-material class="Page-paper" elevation="1">
			<p class="paper-font-subhead">Things Message Box / Spinner</p>

			<div class="buttons">
				<paper-button raised id="msg-button">Message Box</paper-button>
				<paper-button raised id="msg-html-button">Message Box - HTML</paper-button>
				<paper-button raised id="confirm-button">Confirm Box</paper-button>
				<paper-button raised id="prompt-button">Prompt Box</paper-button>
				<paper-button raised id="spn-button">Spinner</paper-button>
			</div>      
		</paper-material>

		<paper-material class="Page-paper" elevation="1">
			<p class="paper-font-subhead">Things Event Handler</p>

			<div class="buttons">
				<paper-button raised id="evt-button">Fire Event</paper-button>
			</div>
		</paper-material>

		<paper-material class="Page-paper" elevation="1">
			<p class="paper-font-subhead">Web Socket</p>

			<paper-input  
				name="wsurl" 
				type="text" 
				label="Web Socket URL" 
				value="{{wsUrl}}">
			</paper-input>

			<paper-input  
				name="status" 
				type="text" 
				label="Web Socket Status" 
				value="{{wsStatus}}">
			</paper-input>

			<paper-input  
				name="message" 
				type="text" 
				label="Message To Send" 
				value="{{wsSendMessage}}">
			</paper-input>

			<paper-input  
				name="returnMessage" 
				type="text" 
				label="Received Message" 
				value="[[wsReceiveMessage]]">
			</paper-input>

			<div class="buttons">
				<paper-button raised id="ws-open-button">Open</paper-button>
				<paper-button raised id="ws-send-button">Send Message</paper-button>
				<paper-button raised id="ws-close-button">Close</paper-button>
			</div>
		</paper-material>

		<paper-material class="Page-paper" elevation="1">
			<p class="paper-font-subhead">Things Alarm</p>

			<things-alarm-badge count="3"></things-alarm-badge>

			<div class="buttons">
				<paper-button raised id="alarm-button">Alarm Badge Click</paper-button>
			</div>
		</paper-material>

		<paper-material class="Page-paper" elevation="1">
			<p class="paper-font-subhead">Things Combo</p>

			<paper-input label="Selected Value" value="{{codeName}}"></paper-input>

			<paper-input label="Selected Description" value="{{codeDesc}}"></paper-input>

			<things-combo 
				id="combo" 
				label="Language" 
				value="en-US" 
				items="{{comboItems}}" 
				label-path="description" 
				value-path="name">
			</things-combo>

			<things-code-combo 
				id="code-selector" 
				label="Language" 
				value="en-US" 
				code-name="LOCALE" 
				label-path="description" 
				value-path="name">
			</things-code-combo>

		</paper-material>

		<paper-material class="Page-paper" elevation="1">
			<p class="paper-font-subhead">Date Picker</p>
			<things-date-picker label="Date Picker" locale="ko" read-format="YYYY-MM-DD"></things-date-picker>
		</paper-material>

		<paper-material class="Page-paper" elevation="1">
			<p class="paper-font-subhead">Time Picker</p>
			<things-time-picker label="Time Picker"></things-time-picker>
		</paper-material>

		<paper-material class="Page-paper" elevation="1">
			<p class="paper-font-subhead">Date Picker From To</p>
			<things-date-from-to locale="ko" read-format="YYYY-MM-DD"></things-date-from-to>
		</paper-material>

		<things-msg-box id="msg-box" title="Things Message Box" message="This is Message Box"></things-msg-box>

		<things-websocket id="ws" url="{{wsUrl}}"></things-websocket>

		<!-- code Editor -->
		<paper-material elevation="1">
			<h2>Things Template Editor</h2>
			<things-template-editor 
				id="template-editor"
				theme="ace/theme/monokai"
				mode="ace/mode/html"
				resource="{{code_resource}}"
				template-field ="source"
				save-url ="hi">
			</things-template-editor>
		</paper-material>		

	</template>

	<!--script src="things-demo.js"></script-->

	<script>
		Polymer({
			is: 'things-demo',

			properties: {
				title: {
					value: 'Title'
				},

				wsUrl: {
					value: 'ws://localhost:9004/ws'
				},
			  
				wsStatus: {
					value: 'disconnected'
				},

				comboItems: {
					type: Array,
					value: [ {
						name : 'ko-KR', description: '한글'
					}, {
						name : 'en-US', description: 'English'
					}, {
						name : 'zh-CN', description: 'Chinese'
					} ],
					notify: true
			  },

				code_resource: {
					type: Object,
					value: {
						name: 'test',
						source: '<body><h2>Things Template Editor</h2></body>'
					}
			  }
			},

			behaviors : [
				Things.MsgBoxBehavior, 
				Things.GlobalBehavior,
				Things.SpinnerBehavior,
			],

			listeners: {
				'setting-btn.tap' : 'onTapSetting',
				'things-btn-1.tap' : 'onTapThingsButton1',
				'things-btn-2.things-button-confirm' : 'onConfirmMsgBox',
				'things-btn-3.things-button-confirm' : 'onConfirmMsgBox',
				'msg-button.tap' : 'onTapMsgButton',
				'msg-html-button.tap' : 'onTapMsgHtmlButton',
				'confirm-button.tap' : 'onTapConfirmButton',
				'prompt-button.tap' : 'onTapPromptButton',
				'spn-button.tap' : 'onTapSpnButton',
				'evt-button.tap' : 'onTapEvtButton',
				'ws-open-button.tap' : 'onTapWsOpenButton',
				'ws-send-button.tap' : 'onTapWsSendButton',
				'ws-close-button.tap' : 'onTapWsCloseButton',
				'msg-box.confirm' : 'onConfirmMsgBox',
				'ws.onmessage' : 'onWsMessageReceive',
				'ws.onerror' : 'onWsMessageReceive',
				'ws.onopen' : 'onWsMessageReceive',
				'ws.onclose' : 'onWsMessageReceive',
				'combo.things-combo-value-changed' : 'onComboValueChanged',
				'code-selector.things-combo-value-changed' : 'onComboValueChanged',
				// 'loadHTMLPreview.tap':'onTapLoadHTMLPreview'
			},

			onTapSetting: function(e) {
				this.$.setting.open();
			},

			onTapThingsButton1: function(e) {
				this.thingsButtonMessage = e.srcElement.innerText + ' Pressesd';
			},

			onTapMsgButton: function(e) {
				this.openInfoMsg({ title : 'Info Title', text : 'Info Message', type : 'info', timer : 3000 });
			},

			onTapMsgHtmlButton: function(e) {
				this.openInfoMsg({ title : 'Info Title', html : true, text : '<a href="#">error_id</a>', type : 'info', timer : 3000 });
			},

			onTapConfirmButton: function(e) {
			  this.openConfirmMsg({ 
			  	title: 'Are you sure?',
					text: 'You will not be able to recover this imaginary file!',
					type: 'warning',
					showCancelButton: true,
					confirmButtonColor: '#DD6B55',
					confirmButtonText: 'Yes, delete it!',
					cancelButtonText: 'No, cancel plx!',
					closeOnConfirm: false,
					closeOnCancel: false 
				}, this.okCallback, this.cancelCallback);
			},

			okCallback: function() {
				swal('Deleted!', 'Your imaginary file has been deleted', 'success');
			},

			cancelCallback: function() {
				swal('Cancelled', 'Your imaginary file is safe.', 'error');
			},

			onTapPromptButton: function(e) {
			  this.openPromptMsg({ 
					title : 'An input!',
					text : 'Write something interesting!',
					type : 'input',
					showCancelButton: true,
					closeOnConfirm : false,
					animation : 'slide-from-too',
					inputPlaceholder : 'Write Something' 
				}, this.promptCallback);
			},

			promptCallback: function(inputValue) {
				swal("Nice!", "You wrote: " + inputValue, "success");
			},

			onTapSpnButton: function(e) {
				this.toggleSpinner();
			},

			onTapEvtButton: function(e) {
				// index.html에 event-handler 추가
				app.$['event-handler'].fire('showMessage', { title : 'This is Title', message : 'This is Message!' });
			},

			onTapWsOpenButton: function(e) {
				this.$.ws.open();
			},

			onTapWsSendButton: function(e) {
				this.$.ws.send(this.wsSendMessage);
			},

			onTapWsCloseButton: function(e) {
				this.wsSendMessage = '';
				this.$.ws.close();  
			},

			onConfirmMsgBox: function(e) {
				if(e.detail == 'ok') {
					this.thingsButtonMessage = e.detail + ' pressed';
				} else {
					this.thingsButtonMessage = e.detail + ' pressed';
				}
			},

			onWsMessageReceive: function(e) {
				if(typeof(e.detail) == "string") {
					this.wsReceiveMessage = e.detail;  
				} else {
					this.wsReceiveMessage = e.type;
					this.wsStatus = this.$.ws.status();
				}
			},

			onComboValueChanged: function(e) {
				if(e.detail) {
					this.codeName = e.detail.value;
					this.codeDesc = e.detail.item ? e.detail.item.description : '';
				}
			},

			onTapLoadHTMLPreview: function(e){
				this.$['html-preview'].srcdoc = this.code_resource.source;
			}

		});
	</script>  

</dom-module>